<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>json and hash operations</h1>
  <!-- 1. Convert JSON Text to JavaScript Object -->
  <h3>Convert JSON to Object</h3>
  <textarea id="jsonText" rows="4" cols="50" placeholder="Enter JSON here"></textarea><br>
  <button onclick="convertJsonToObject()">Convert to Object</button>
  <pre id="jsonResult"></pre>

  <!-- 2. Convert JSON Date String to Date Object -->
  <h3>Convert JSON Date to Date Object</h3>
  <textarea id="jsonDate" rows="4" cols="50" placeholder='{"date": "2024-12-24T12:00:00Z"}'></textarea><br>
  <button onclick="convertJsonDate()">Convert to Date</button>
  <pre id="jsonDateResult"></pre>

  <!-- 3. Convert JSON to CSV and CSV to JSON -->
  <h3>Convert JSON to CSV</h3>
  <textarea id="jsonForCSV" rows="4" cols="50" placeholder='[{"name":"John","age":30},{"name":"Jane","age":25}]'></textarea><br>
  <button onclick="jsonToCsv()">Convert to CSV</button>
  <pre id="csvResult"></pre>

  <h3>Convert CSV to JSON</h3>
  <textarea id="csvInput" rows="4" cols="50" placeholder="name,age\nJohn,30\nJane,25"></textarea><br>
  <button onclick="csvToJson()">Convert to JSON</button>
  <pre id="jsonFromCsvResult"></pre>

  <!-- 4. Create Hash from String -->
  <h3>Create Hash from String</h3>
  <input type="text" id="inputString" placeholder="Enter string to hash"><br>
  <button onclick="createHash()">Create Hash</button>
  <pre id="hashResult"></pre>

  
  <script>
    //1.JsonToObject
    function convertJsonToObject(){
        const jsonText=document.getElementById('jsonText').value;
        try{
            const jsonObject=JSON.parse(jsonText);
            document.getElementById('jsonResult').textContent=JSON.stringify(jsonObject,null,2);

        }
        catch(e){
            document.getElementById('jsonResult').textContent='Invalid JSON';

        }
    }

    //convert json to csv

    function jsonToCsv(){
        const jsonText = document.getElementById('jsonDate').value;
        try{
            const jsonObject = JSON.parse(jsonText); // Parse JSON
            if(jsonObject.date){
                const date=new Date(jsonObject.date);
                document.getElementById('jsonDateResult').textContent = date.toString(); 


            }else{
                throw new Error("Missing date key in the json");
            }
        }catch(e){
            document.getElementById('jsonDateResult').textContent = 'Invalid JSON or Date Format!';
        }
    }

//
function jsonToCsv() {
  const jsonText = document.getElementById('jsonForCSV').value;
  try {
    const jsonArray = JSON.parse(jsonText); // Parse JSON array
    console.log(jsonArray)
    if (!Array.isArray(jsonArray) || jsonArray.length === 0) {
      throw new Error('JSON must be an array with at least one object');
    }

    const keys = Object.keys(jsonArray[0]); // Extract headers

    // Generate the header row
    let csv = keys.join(',') + '\r\n';

    // Generate the data rows
    for (let row of jsonArray) {
      let rowValues = keys.map(key => JSON.stringify(row[key] || '')).join(',');
      csv += rowValues + '\r\n';
    }

    document.getElementById('csvResult').textContent = csv; // Display CSV
  } catch (e) {
    document.getElementById('csvResult').textContent = 'Invalid JSON!';
  }
}

//
function csvToJson(){
    const csvToJsonInput = document.getElementById('csvToJsonInput').value;
    try{
        const lines=csvToJson.Trim().split('\n');
        if(lines.length<2) throw new Error('invalid');
        const headers=lines[0].split(',')
        console.log(headers)

    }
}

  </script>

</body>
</html>